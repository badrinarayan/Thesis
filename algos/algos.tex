%!TEX root = ../dissertation.tex
\chapter{Algorithms}
\label{chap:algos}

As alluded to in Chapter 1, the problems of atomic norm decomposition and
regularization have linear and quadratic objectives can be efficiently computed
provided there is an efficient way to test membership in the constraint sets.
The constraint sets of the primal and dual problems are the sublevel sets of the
atomic and the dual atomic norm. Therefore, it is sufficient to develop
efficient characterizations of the atomic norm ball.

For the special case of Fourier measurements, the atomic norm ball has
semidefinite characterizations which we derive in this chapter. The positive
case is classical and comes from moment theory and the dual theory of positive
polynomials. We will review the results for the positive case and provide the
proofs for completeness. We will also derive the semidefinite characterization
for the more general complex case using these results.

For the problem of system identification, there are no tractable semidefinite
formulations. While it is possible to develop a sequence of semidefinite
relaxations, we instead describe how we can use a discretization approach for
the atomic soft thresholding (AST) problem described in Chapter~\ref{chap:ast}
and this essentially reduces to solving a Lasso problem on an overcomplete grid.
Our proofs for discretized atomic soft thresholding (DAST) demonstrate why Lasso
is often successful even for off-grid data.

\section{Trigonometric Moments}

Given a measure $\mu$ defined on $\mathbb{T}$, recall that the $m$th
trigonometric moment is defined by
\begin{equation}
	\label{eq:trig-moment-measure}
	x_m = \int_\mathbb{T} e^{i 2 \pi k f} \mu ( d f)
\end{equation}
The classical trigonometric moment problem asks when the sequence of moments
$\{x_m\}_{m=-\infty}^{\infty}$ characterizes the measure $\mu$. When the measure $\mu$ is discrete and is composed of atoms at $f_1, \ldots, f_l$, we can write
\[
\mu(f) = \sum_{l=1}^k c_l \xi_{f_l}
\]
where $\xi_f$ denotes the point measure at $f$ and $\set{c_l}$ are the amplitudes. In this case, we have
\begin{align}
	x_m &= \int_\mathbb{T} e^{i 2 \pi k f} \sum_{l=1}^k c_l \xi_{f_l}(d f)\\
	&= \sum_{l=1}^k c_l e^{i 2 \pi f_l m}.
\end{align}
Define the trigonometric monomial $a(f)$ by
\[
a(f) = \begin{pmatrix}
	1\\
	e^{i 2\pi f}\\
	\vdots\\
	e^{i2\pi f (n-1)}
\end{pmatrix}
\] as in Chapter~\ref{chap:linespect}. Then the moment vector
$x = \begin{pmatrix}x_0 & \cdots & x_{n-1}\end{pmatrix} \in \C^n$ is given by
\[
x = \sum_{l=1}^k c_l a(f_l)
\]
Thus, depending on whether $\set{c_l}$ are positive or complex, the $x$ lies in
the conical hull of $\A_+$ or $\A$.

\section{Duality : Moments and Polynomials}
In this chapter, we develop semidefinite characterizations for the atomic sets
\begin{align}
\A_+ = \setof{a(f)}{f \in \mathbb{T}}\\
\A = \setof{a(f) \exp(i 2\pi \phi)}{f, \phi \in \mathbb{T}}
\end{align}
and a corresponding characterization of the dual atomic set
\begin{align}
\A^*_+ = \setof{q \in \C^n}{\sum_{j=0}^{n-1}{q_j \exp(i 2\pi j f)} \geq 0, \text{ for all } f \in \mathbb{T}}\\
\\A^* = \setof{q \in \C^n}{\sum_{j=0}^{n-1}{|q_j \exp(i 2\pi j f)|} \geq 0, \text{ for all } f \in \mathbb{T}}
\end{align}

The sets $\cone(\A_+)$ (resp $\cone(\A$)) and $\cone(\A^*_+)$ (resp
$\cone(\A^*$)) are dual cones. Interestingly, for the positive case, the
characterizations of the conical hulls of the atomic norm balls are sufficient
to characterize the norm balls themselves. The general case requires a little
more computation.

\section{Positive Trigonometric Moments}

The conical hull of the atomic set $\A_+$ given by $\cone(\A_+)$ is called the
trigonometric moment cone and has a classical characterization due to
Caratheodory-Toeplitz theorem.Before we state the theorem, we will need a bit of
notation. Define the map $T:\mathbb{C}^n \rightarrow \mathbb{C}^{n\times n}$
which creates a Hermitian Toeplitz matrix out of its input, that is
\[
T(x)= \left[
\begin{array}{ccccc} x_1 & x_2 & \ldots & x_n\\ 
x^*_2 & x_1  & \ldots & x_{n-1}\\
 \vdots & \vdots & \ddots & \vdots\\
 x^*_n & x^*_{n-1}  & \ldots & x_1
 \end{array}\right]
\]

\begin{theorem}[Caratheodory-Toeplitz theorem]
	$x \in \C^n$ corresponds to the first $n$ trigonometric moments of a measure $\mu$ (i.e., $x \in \cone(\A_+)$) if and only if $T x \succeq 0.$
\end{theorem}

This theorem can be proved using Herglotz theorem~\cite{herglotz} and the idea
of flat extensions studied in~\cite{Curto97}. We provide a simple version of the
proof of this theorem in the appendix.\todo{Do this or skip} We refer the
interested reader to~\cite{grenander01} for an alternative algebraic proof.

Now, as a consequence of the moment cone characterization, we have a simple characterization of the moment sequences. 

\begin{theorem}
	$\vnorm{x}_{\A_{+}} \leq 1$ if and only if $T x \geq 0$ and $x_1 \leq 1$.
\end{theorem}
\begin{proof}
If $T x \succeq 0$, then there exists an atomic decomposition $x = \sum_l c_l a(f_l)$ by Caratheodory-Toeplitz theorem since it is in the conical hull of the atomic set $\A_+$. Since we have an invariant $x_0 = \sum_l c_l$ for any such decomposition, we have that
\[
\vnorm{x}_{\A_{+}}  = \inf\setof{\sum_{c_l}}{x = \sum_l c_l} = x_1.
\]
On the other hand, if $Tx \not\succeq 0$, $x \not\in \cone(\A_+)$ and thus $\vnorm{x}_{\A_{+}} = +\infty$.
\end{proof}

\section{Positive Trigonometric Polynomials}

A vector $q \in \C^n$ is called a $n$th degree positive trigonometric polynomial
if $\Re\sum_{j=1}^{n} q_{j-1} \exp(i2\pi j f) \geq 0$ for every $f \in
\mathbb{T}.$ Such polynomials have a simple characterization due to spectral
factorization theorem.

\begin{definition}
A vector $q \in \C^n$ is a positive trigonometric polynomial if
for every $f \in \mathbb{T},~ \Re\sum_{j=1}^{n} q_{j-1} \exp(i2\pi j f) \geq 0.$
\end{definition}

\section{General Trigonometric Moments}
\subsection{Atomic Norm and Caratheory-Toeplitz theorem}
\subsection{Dual Atomic Norm and Bounded Real Lemma}
Recall from \eqref{eq:dual-norm-poly} that the dual atomic norm of a vector $v
\in \mathbb{C}^n$ is the maximum absolute value of a complex trigonometric
polynomial $V(f) = \sum_{l=0}^{n-1} v_l e^{-2\pi i l f}$. As a
consequence, a constraint on the dual atomic norm is equivalent to
a bound on the magnitude of $V(f)$:
\begin{align*}
\|v\|_\A^* \leq \tau \Leftrightarrow |V(f)|^2 \leq \tau^2, \forall f \in [0, 1].
\end{align*}
The function $q(f) = \tau^2-|V(f)|^2$ is a trigonometric polynomial (that is, a
polynomial in the variables $z$ and $z^*$ with $|z|=1$). A necessary and
sufficient condition for $q(f)$ to be nonnegative is that it can be written as
a sum of squares of trigonometric polynomials~\cite{Megretski03}. 
Testing if $q$ is a sum of squares can be achieved
via semidefinite programming. Let $T^*$ denote the adjoint of the map $T$. Then we have the following
succinct characterization

\begin{lemma}\cite[Theorem 4.24]{brl2007}\label{lm:brl} For any given causal trigonometric polynomial $V(f) = \sum_{l=0}^{n-1} v_l
e^{-2\pi i l f}$, $|V(f)| \leq \tau $ if and only if there exists complex
Hermitian matrix $Q$ such that
\begin{align*}
T^*(Q) = \tau^2 {e}_1~~\mbox{and}~~
\begin{bmatrix}
  Q & v \\
  v^* & 1
 \end{bmatrix} \succeq 0.
\end{align*}
Here, ${e}_1$ is the first canonical basis vector with a one at the first
component and zeros elsewhere and $v^*$ denotes the Hermitian adjoint
(conjugate transpose) of $v$.
\end{lemma}

\section{SDP for Atomic Soft Thresholding}
\label{sec:sdp-ast}

In this section, we present a semidefinite characterization of the atomic norm
associated with the line spectral atomic set $\mathcal{A} = \{a_{f,\phi} | f
\in [0, 1], \phi \in [0, 1]\}$. This characterization allows us to rewrite
 {\eqref{AST}} as an equivalent semidefinite programming problem.



Using Lemma \ref{lm:brl}, we rewrite the atomic norm $\|x\|_\A =
\sup_{\|v\|_\A^*\leq 1} \left<x, v\right> $ as the following semidefinite
program:
\begin{equation}\label{eq:sdpprimal}
 \begin{array}{ll}
\operatorname*{maximize}_{v,\ Q} & \left<x, v\right>\\
\text{subject  to}  &
 \begin{bmatrix}
  Q & v \\
  v^* & 1
 \end{bmatrix} \succeq 0, \qquad  T^*(Q) = {e}_1 .
\end{array}
\end{equation}
The dual problem of \eq{sdpprimal} (after a trivial rescaling) is then equal to
the atomic norm of $x$:
\begin{align*}
\begin{array}{lll} \|x\|_\A =&  \min_{t, u} & \tfrac{1}{2} (t + u_1)  \\
&\operatorname{subject\ to}
& \begin{bmatrix}
  T(u) & x \\
  x^* & t
 \end{bmatrix} \succeq 0.\end{array}
\end{align*}
Therefore, the atomic denoising problem \eqref{AST} for the set of trigonometric atoms is equivalent to
\begin{equation}\label{eq:sdpdenoising}
\begin{array}{ll}
\operatorname*{minimize}_{t, u, x} & \frac{1}{2} \|x - y\|_2^2 + \frac{\tau}{2}(t + u_1) \\
\operatorname{subject\ to}
& \begin{bmatrix}
  T(u) &  x \\
 x^* & t
 \end{bmatrix} \succeq 0.\end{array} 
\end{equation}

The semidefinite program \eq{sdpdenoising} can be solved by off-the-shelf
solvers such as SeDuMi~\cite{sedumi} and SDPT3~\cite{SDPT3}. However, these
solvers tend to be slow for  large problems. For the interested reader, we provide a reasonably efficient algorithm based upon the Alternating Direction Method of Multipliers.

\section{Alternating Direction Method of Multipliers}
\label{sec:admm}

\subsection{Decomposition}
\subsection{Missing Samples}
\subsection{Denoising}


A thorough survey of the ADMM algorithm is given in~\cite{admm2011}. We only
present the details essential to the implementation of atomic norm soft
thresholding. To put our problem in an appropriate form for ADMM,
rewrite~\eq{sdpdenoising} as
\begin{equation*}
\begin{array}{ll}
\operatorname*{minimize}_{t, u, x,Z} & \frac{1}{2} \|x - y\|_2^2 + \frac{\tau}{2}(t + u_1) \\
\operatorname{subject\ to}
& Z=\begin{bmatrix}
  T(u) & x \\
  x^* & t
 \end{bmatrix} \\
& Z\succeq 0.\end{array} 
\end{equation*}
and dualize the equality constraint via an Augmented Lagrangian:
\begin{align*}
\mathcal{L}_\rho (t,u,x,Z, \Lambda)= \frac{1}{2} \|x - y\|_2^2 + \frac{\tau}{2}(t +  u_1) + \\
\left\langle   \Lambda, Z-\begin{bmatrix}
  T(u) & x \\
  x^* & t
 \end{bmatrix} \right\rangle +
  \frac{\rho}{2} \left\| Z-\begin{bmatrix}
  T(u) & x \\
  x^* & t
 \end{bmatrix} \right\|_F^2
\end{align*}

ADMM then consists of the update steps:
\begin{align*}
(t^{l+1},u^{l+1},x^{l+1})  \leftarrow \arg\min_{t,u,x} \mathcal{L}_\rho(t,u,x,Z^l, \Lambda^l) \\
Z^{l+1}  \leftarrow \arg\min_{Z\succeq 0}  \mathcal{L}_\rho(t^{l+1},u^{l+1},x^{l+1}, Z, \Lambda^l ) \\
\Lambda^{l+1}  \leftarrow \Lambda^l + \rho  \left( Z^{l+1}-\begin{bmatrix}
  T(u^{l+1}) &  x^{l+1} \\
  {x^{l+1}}^* & t^{l+1}
 \end{bmatrix} \right).
\end{align*}
The updates with respect to $t$, $x$, and $u$ can be computed in closed form:
\begin{align*}
    t^{l+1} &= Z_{n+1,n+1}^l+\left(\Lambda_{n+1,n+1}^l-\frac{\tau}{2}\right)/\rho\\
	 x^{l+1} &= \frac{1}{2\rho+1}(y  + 2\rho z_1^{l} + 2\lambda_1^l)\\
    u^{l+1} &= W \left(T^*(Z_0^l+ \Lambda_0^l/\rho) - \frac{\tau }{2\rho} {e}_1\right)
\end{align*}
Here $W$ is the diagonal matrix with entries
\[
	W_{ii} = \begin{cases} 
		\frac{1}{n} & i=1\\
		\frac{1}{2(n-i+1)} & i>1
	\end{cases}
\]
and we introduced the partitions:
\[
	Z^l = \begin{bmatrix} Z_0^l & z_1^l \\ {z_1^l}^* & Z^l_{n+1,n+1} \end{bmatrix} ~~~\mbox{and}~~~
	\Lambda^l = \begin{bmatrix} \Lambda_0^l & \lambda_1^l \\ {\lambda_1^l}^* & \Lambda^l_{n+1,n+1} \end{bmatrix}\,.
\]
The $Z$ update is simply the projection onto the positive definite cone
\begin{equation}\label{eq:z-step}
\hspace{-.3cm}Z^{l+1}:=	 \arg\min_{Z\succeq 0} \left\|Z-\begin{bmatrix}
  T(u^{l+1}) &  x^{l+1} \\
   {x^{l+1}}^* & t^{l+1}
 \end{bmatrix}+\Lambda^{l}/\rho\right\|_F^2\,.
\end{equation}
Projecting a matrix $Q$ onto the positive definite cone is accomplished by
forming an eigenvalue decomposition of $Q$ and setting all negative eigenvalues
to zero.

To summarize, the update for $(t,u,x)$ requires averaging the diagonals of a
matrix (which is equivalent to projecting a matrix onto the space of Toeplitz
matrices), and hence operations that are $O(n)$. The update for $Z$ requires
projecting onto the positive definite cone and requires $O(n^3)$ operations. The update for $\Lambda$ is simply
addition of symmetric matrices.  

Note that the dual solution $\hat{z}$ can be obtained as $\hat{z} = y - \hat{x}$ from the
primal solution $\hat{x}$ obtained from ADMM by using
Lemma~\ref{lem:dual-problem}.

\section{DAST}
\subsection{Line Spectral Signals}
\subsection{Discretization and Lasso}
\label{sec:comp-method}
When the number of samples is larger than a few hundred, the running time of
our ADMM method is dominated by the cost of computing eigenvalues and is
usually expensive~\cite{12BhaskarArxiv}. For very large problems, we now propose using Lasso as an
alternative to the semidefinite program~\eq{sdpdenoising}. To proceed, pick a
uniform grid of $N$ frequencies and form $\A_N = \left\{ a_{m/N,\phi}
~\middle|~ 0 \leq m \leq N-1 \right\} \subset \A $ and solve \eqref{AST} on
this grid. i.e., we solve the problem
\begin{equation}
	\label{epsprimal} \text{minimize }\frac{1}{2} \vnorm{x - y}_2^2 + \tau \vnorm{x}_{\A_N}. 
\end{equation}

To see why this is to our advantage, define $\Phi$ be the $n \times N$ Fourier
matrix with $m$th column $a_{m/N,0}$. Then for any $x \in \C^n$ we have $\vnorm{x}_{\A_N} = \min\left\{ \vnorm{c}_1: x = \Phi c \right\}$.
So, we solve
\begin{equation}
	\label{sparsa} \text{minimize }\frac{1}{2} \vnorm{\Phi c- y}_2^2 + \tau \vnorm{c}_1. 
\end{equation}
for the optimal point $\hat{c}$ and set $\hat{x}_N = \Phi \hat{c}$ or the first
$n$ terms of the $N$ term discrete Fourier transform (DFT) of $\hat{c}$.
Furthermore, $\Phi^* z$ is simply the $N$ term inverse DFT of $z \in \C^n$.
This observation coupled with Fast Fourier Transform (FFT) algorithm for
efficiently computing DFTs gives a fast method to solve \eqref{epsprimal},
using standard compressed sensing software for $\ell_2-\ell_1$ minimization,
for example, SparSA~\cite{wright09}.

Because of the relatively simple structure of the atomic set, the optimal
solution $\hat{x}$ for \eqref{epsprimal} can be made arbitrarily close to
\eqref{eq:sdpdenoising} by picking $N$ a constant factor larger than $n$. In
fact, we show that the atomic norms on $\A$ and $\A_N$ are equivalent (See
Appendix \ref{proof:dual-norm-approximation}):
\begin{equation}
 \left(1-\frac{2\pi n}{N}\right) \vnorm{x}_{\A_N} \leq  \vnorm{x}_\A \leq \vnorm{x}_{\A_N}, \forall x \in \C^n
\end{equation}
Using Proposition
\ref{prop:grid-approx-mse} and \eq{tau}, we conclude
{\small
\begin{align*}
\frac{1}{n} \E \vnorm{\hat{x}_N - x^\star}_2^2 
&\leq
\frac{\sigma\left(\frac{\log(n)+1}{\log(n)}\right)\vnorm{x^\star}_\A
\sqrt{ n \log(n) + 
    n\log(4\pi\log(n))
}}{n\left(1 - \frac{2\pi n}{N}\right)} =
O\left(
\sigma \sqrt{\frac{\log(n)}{n}} \frac{ \vnorm{x^\star}_\A}{\left(1 - \frac{2\pi n}{N}\right)}
\right)
\end{align*}
}

Due to the efficiency of the FFT, the discretized approach
has a much lower algorithmic complexity than either Cadzow's alternating
projections method or the ADMM method described in  the extended technical report~\cite{12BhaskarArxiv},
which each require computing an eigenvalue decomposition at
each iteration. Indeed, fast solvers for~\eqref{sparsa} converge to an
$\epsilon$ optimal solution in no more than $1/\sqrt{\epsilon}$ iterations.
Each iteration requires a multiplication by $\Phi$ and a simple ``shrinkage''
step. Multiplication by $\Phi$ or $\Phi^*$ requires $O(N\log N)$ time and the
shrinkage operation can be performed in time $O(N)$.

As we discuss below, this fast form of basis pursuit has been proposed by
several authors. However, analyzing this method with tools from compressed
sensing has proven daunting because the matrix $\Phi$ is nowhere near a
restricted isometry. Indeed, as $N$ tends to infinity, the columns become more
and more coherent. However, common sense says that a larger grid should give
better performance, for both denoising and frequency localization! Indeed, by appealing to the atomic norm framework, we are
able to show exactly this point: the larger one makes $N$, the closer one
approximates the desired atomic norm soft thresholding problem. Moreover, we do
not have to choose $N$ to be too large in order to achieve nearly the same
performance as the AST.



\section{System ID Algorithms}

\section{Algorithms for atomic norm minimization}\label{sec:computation}

From here on, let us assume that the $G_\star$ that we seek to estimate has all of its poles of magnitude at most $\rho$  ( we will call $\rho$ the \emph{stability radius}, and treat it as a known parameter).  Let $\D_\rho$ denote the set of all complex numbers with norm at most $\rho$.  Note that if $G_\star$ has stability radius $\rho$ then
\[
	\|G\|_{\cA}:=\inf\left\{ \sum_{w\in \D_\rho} |c_w|~:~G(z) = \sum_{w\in \D_\rho} \frac{c_w (1-|w|^2)}{z-w}\right\}\,.
\]
That is, we can restrict our set of atoms to only be those single pole systems with stability radius equal to $\rho$.  For the remainder of this manuscript, we assume that $\cA$ only consists of such single pole systems.

In what follows, we focus our attention on linear measurement maps.  Let $\cL_i: \cH \mapsto \C $ be a linear functional that serves as a measurement operator for the system $G(z)$.  Many maps of interest can be phrased as linear functionals of the transfer function,
\begin{enumerate}
	\item Samples of the frequency response $\mathcal{L}_k(G):=G(e^{i\theta_k})$ for $k=1,\ldots, n$.  From a control theoretic perspective, this measurement operator corresponds to measuring the gain and phase of the linear system at different frequencies.
	\item Samples of the impulse response, $\mathcal{L}_k(G):=g_{i_k}$ for $k=1,\ldots, n$ and $i_k \in [1,\infty)$.
	\item Convolutions of the impulse response with a pseudorandom signal $u_k$: $\mathcal{L}_k(G):=\sum_{j=1}^{\infty} g_j u_{k-j}$.
\end{enumerate}

In all of these cases, we consider the problem
\begin{equation}\label{eq:atomic-norm-lin-inverse}
	\minimize_{G} \tfrac{1}{2} \sum_{i=1}^n |\cL_i(G) - y_i |^2 + \mu \|G\|_{\cA}\,.
\end{equation}
This problem is equivalent to the constrained, semi-infinite programming problem
\[
	\begin{array}{ll}
	\minimize_{x,G} & \tfrac{1}{2}\sum_{k=1}^n |x_k - y_k |^2 + \mu \sum_{w\in \D_\rho} |c_w|\\
	\st & x_k = \cL_k(G)~~\mbox{for}~i=1,\ldots, n\\
	& G = \sum_{w\in \D_\rho} \frac{c_w(1-|w|^2)}{z-w}
	\end{array}
\]
Eliminating the equality constraint gives yet another equivalent formulation
\begin{equation}\label{eq:atomic-norm-lin-inverse-finite-dim}
	\begin{array}{ll}
	\minimize_{x} & \tfrac{1}{2}\sum_{k=1}^n |x_k - y_k |^2 + \mu \sum_{w\in \D_\rho} |c_w|\\
	\st & x_k = \sum_{w\in \D_\rho} c_w \cL_k\left(\frac{1-|w|^2}{z-w}\right)~~\mbox{for}~i=1,\ldots, n\,.
	\end{array}
\end{equation}
Note that in this final formulation, our decision variable is $x$, a finite dimensional vector, and $c_w$, the coefficients of the atomic decomposition.  The infinite dimensional variable $G$ has been eliminated.  Let us define a norm on $\R^n$ based on the formulation~\eq{atomic-norm-lin-inverse-finite-dim}
\[
	\|x\|_{\cL(\cA)} = \inf \left\{ \sum_{w\in \D_\rho} |c_w| ~:~ x_i = \sum_{w\in\D_\rho} c_w\mathcal{L}_i\left(\frac{1-|w|^2}{z-w} \right)\right\}\,.
\]
Then we see that problem~\eq{atomic-norm-lin-inverse} is equivalent to the denoising problem
\begin{equation}\label{eq:finite-dim-ast}
	\minimize_{x} \tfrac{1}{2}\|x-y\|_2^2 + \mu \|x\|_{\cL(\cA)}\,.
\end{equation}
Note that the first term is simply the squared Euclidean distance between $y$ and $x$ in $\R^n$.  The second term is an atomic norm on $\R^n$ induced by the linear map of the set of transfer functions via the measurement operator $\cL$.  In order to tractably solve~\eq{atomic-norm-lin-inverse}, we thus only need focus on computational schemes for computing or approximating $\|x\|_{\cL(\cA)}$.  The following proposition asserts that we can approximate this finite dimensional atomic norm via a sufficiently fine discretization of the unit disk.



\begin{prop}\label{prop:grid}
Let $\D_\rho^{(\epsilon)}$ be a finite subset of the unit disc such that for any $w \in \D_\rho$ there exists a $v \in \D_\rho^{(\epsilon)}$ satisfying $|w-v| \leq \epsilon$.  Define
\[
	\|x\|_{\cL(\cA_\epsilon)} = \inf\left\{ \sum_{w\in \D_{\rho}^{(\epsilon)}} |c_w| ~:~ x_i = \sum_{w\in\D_{\rho}^{(\epsilon)}} c_w\mathcal{L}_i\left(\frac{1-|w|^2}{z-w} \right)\right\}\,.
\]
Then there exists a constant $C_\epsilon \in [0,1]$ such that
\[
	C_\epsilon \|x\|_{\cL(\cA_{\epsilon})} \leq \|x\|_{\cL(\cA)} \leq \|x\|_{\cL(\cA_{\epsilon})} \,.
\]
\end{prop}
\noindent The set $\D_\rho^{(\epsilon)}$ is called an $\epsilon$-net for the set $\D_\rho$.  We show in the appendix that when $\mathcal{L}_k(G) = G(e^{i\theta_k})$, $C_{\epsilon}$ is at least $(1-\tfrac{16 \rho \epsilon}{\pi(1-\rho)})$.  Other measurement ensembles can be treated similarly.

When we replace $\|x\|_{\cL(\cA)}$ with its discretized counterpart $\|x\|_{\cL(\cA)}$ in~\eq{finite-dim-ast}, 
\[
	\minimize_{x} \tfrac{1}{2}\|x-y\|_2^2 + \mu \|x\|_{\cL(\cA_\epsilon)}
\]
is equivalent to
\begin{equation}\label{eq:DAST}
	\minimize_{c}  \tfrac{1}{2}\|Mc-y\|_2^2 + \mu \sum_{w\in \D_\rho^{(\epsilon)}} |c_w|
\end{equation}
where
\[
	M_{ij} = \mathcal{L}_i \left(\tfrac{1-|w_j|^2}{z-w_j}\right)
\]
and $j$ indexes the set $\D_{\rho}^{(\epsilon)}$. That is $M$ is an $n \times |\D_\rho^{(\epsilon)}|$ matrix.  Problem~\eq{DAST} is a weighted $\ell_1$ regularization problem with real or complex data depending on specific problem.  We call~\eq{DAST} \emph{Discretized Atomic Soft Thresholding} (DAST), as coined in~\cite{BhaskarAllerton11}.

The DAST problem can be solved very efficiently with a variety of off-the-shelf tools including SPARSA~\cite{wright09}, FPC~\cite{Hale08} or even more general purpose packages such as YALMIP~\cite{YALMIP} or CVX~\cite{cvx}.  DAST yields an approximate solution to problem~\eq{atomic-norm-lin-inverse}, and, as we will see, yields a statistically consistent estimate provided the parameter $\epsilon$ is adjusted to meet the desired numerical accuracy.

